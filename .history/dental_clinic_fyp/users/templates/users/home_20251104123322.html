{% extends "users/base.html" %}
{% block title %}Welcome to Dental Clinic{% endblock %}
{% load static %}

{% block content %}

{% if messages %}
  {% for message in messages %}
    <div class="alert 
        {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %} 
        alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
{% endif %}

<div class="container text-center mt-5">
    <h1 class="text-center mb-3">Welcome to CrystalSmile Dental</h1>
    <p style="font-size:1.1rem; color:#555;">Your oral health is our priority.</p>
</div>

<!-- Our Services Section -->
<div class="container mt-5">
    <h2 class="text-center mb-4">Our Services</h2>

    <div class="row row-cols-1 row-cols-md-3 g-4" id="services-section" style="display:none;">
        <!-- Hardcoded Services -->
        {% comment %} Services HTML copied from your snippet {% endcomment %}
        <!-- Service 1 -->
        <div class="col">
            <div class="card h-100 shadow-sm" style="border:1px solid #000; border-radius:12px; overflow:hidden; transition: transform 0.3s, box-shadow 0.3s;">
                <img src="{% static 'images/teeth_cleaning.jpg' %}" class="card-img-top" alt="Teeth Cleaning">
                <div class="card-body" style="background-color:#fefefe; padding:20px;">
                    <h5 class="card-title text-primary fw-bold mb-2" style="border-bottom: 2px solid #007B7F; display:inline-block; padding-bottom:5px;">
                        Teeth Cleaning
                    </h5>
                    <p class="card-text text-secondary" style="font-size:0.95rem;">
                        Professional teeth cleaning to remove plaque and maintain oral hygiene.
                    </p>
                </div>
                <div class="card-footer text-center" style="background-color:#f8f9fa; font-weight:600; color:#007B7F;">
                    Rs. 800
                </div>
            </div>
        </div>

        <!-- Service 2 -->
        <div class="col">
            <div class="card h-100 shadow-sm" style="border:1px solid #000; border-radius:12px; overflow:hidden; transition: transform 0.3s, box-shadow 0.3s;">
                <img src="{% static 'images/tooth_whitening.jpg' %}" class="card-img-top" alt="Tooth Whitening">
                <div class="card-body" style="background-color:#fefefe; padding:20px;">
                    <h5 class="card-title text-primary fw-bold mb-2" style="border-bottom: 2px solid #007B7F; display:inline-block; padding-bottom:5px;">
                        Tooth Whitening
                    </h5>
                    <p class="card-text text-secondary" style="font-size:0.95rem;">
                        Brighten your smile with safe and effective whitening treatments.
                    </p>
                </div>
                <div class="card-footer text-center" style="background-color:#f8f9fa; font-weight:600; color:#007B7F;">
                    Rs. 1500
                </div>
            </div>
        </div>

        <!-- Service 3 -->
        <div class="col">
            <div class="card h-100 shadow-sm" style="border:1px solid #000; border-radius:12px; overflow:hidden; transition: transform 0.3s, box-shadow 0.3s;">
                <img src="{% static 'images/filling.jpg' %}" class="card-img-top" alt="Dental Filling">
                <div class="card-body" style="background-color:#fefefe; padding:20px;">
                    <h5 class="card-title text-primary fw-bold mb-2" style="border-bottom: 2px solid #007B7F; display:inline-block; padding-bottom:5px;">
                        Dental Filling
                    </h5>
                    <p class="card-text text-secondary" style="font-size:0.95rem;">
                        Restore decayed teeth with high-quality fillings for durability and comfort.
                    </p>
                </div>
                <div class="card-footer text-center" style="background-color:#f8f9fa; font-weight:600; color:#007B7F;">
                    Rs. 1200
                </div>
            </div>
        </div>

        <!-- Service 4 -->
        <div class="col">
            <div class="card h-100 shadow-sm" style="border:1px solid #000; border-radius:12px; overflow:hidden; transition: transform 0.3s, box-shadow 0.3s;">
                <img src="{% static 'images/braces.jpg' %}" class="card-img-top" alt="Braces">
                <div class="card-body" style="background-color:#fefefe; padding:20px;">
                    <h5 class="card-title text-primary fw-bold mb-2" style="border-bottom: 2px solid #007B7F; display:inline-block; padding-bottom:5px;">
                        Braces
                    </h5>
                    <p class="card-text text-secondary" style="font-size:0.95rem;">
                        Correct misaligned teeth with custom braces for a confident smile.
                    </p>
                </div>
                <div class="card-footer text-center" style="background-color:#f8f9fa; font-weight:600; color:#007B7F;">
                    Rs. 25000
                </div>
            </div>
        </div>

        <!-- Service 5 -->
        <div class="col">
            <div class="card h-100 shadow-sm" style="border:1px solid #000; border-radius:12px; overflow:hidden; transition: transform 0.3s, box-shadow 0.3s;">
                <img src="{% static 'images/root_canal.jpg' %}" class="card-img-top" alt="Root Canal">
                <div class="card-body" style="background-color:#fefefe; padding:20px;">
                    <h5 class="card-title text-primary fw-bold mb-2" style="border-bottom: 2px solid #007B7F; display:inline-block; padding-bottom:5px;">
                        Root Canal Treatment
                    </h5>
                    <p class="card-text text-secondary" style="font-size:0.95rem;">
                        Relieve pain and save your tooth with professional root canal therapy.
                    </p>
                </div>
                <div class="card-footer text-center" style="background-color:#f8f9fa; font-weight:600; color:#007B7F;">
                    Rs. 5000
                </div>
            </div>
        </div>

        <!-- Service 6 -->
        <div class="col">
            <div class="card h-100 shadow-sm" style="border:1px solid #000; border-radius:12px; overflow:hidden; transition: transform 0.3s, box-shadow 0.3s;">
                <img src="{% static 'images/dental_implant.jpg' %}" class="card-img-top" alt="Dental Implant">
                <div class="card-body" style="background-color:#fefefe; padding:20px;">
                    <h5 class="card-title text-primary fw-bold mb-2" style="border-bottom: 2px solid #007B7F; display:inline-block; padding-bottom:5px;">
                        Dental Implant
                    </h5>
                    <p class="card-text text-secondary" style="font-size:0.95rem;">
                        Permanent tooth replacement to restore function and aesthetics.
                    </p>
                </div>
                <div class="card-footer text-center" style="background-color:#f8f9fa; font-weight:600; color:#007B7F;">
                    Rs. 35000
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Doctor Selection -->
<div class="mb-3 mt-5">
    <label style="font-weight:600;color:#002f5f;">Select Doctor</label>
    <select class="form-control" id="doctor-select" required>
        <option value="">-- Choose a Doctor --</option>
        {% for doctor in doctors %}
        <option value="{{ doctor.id }}">{{ doctor.full_name }}</option>
        {% endfor %}
    </select>
    <input type="hidden" name="doctor" id="selected-doctor">
</div>

<!-- Doctor Details -->
<div id="doctor-details" style="display:none; margin-bottom:50px;">
    <img id="doc-profile" src="" alt="Profile Picture" style="width:150px; height:150px; border-radius:50%; border:3px solid #007B7F;">
    <h4 id="doc-name"></h4>
    <p><strong>Degree:</strong> <span id="doc-degree"></span></p>
    <p><strong>Specialization:</strong> <span id="doc-specialization"></span></p>
    <p><strong>Experience:</strong> <span id="doc-experience"></span> years</p>
    <p><strong>Bio:</strong> <span id="doc-bio"></span></p>
</div>

<!-- Footer -->
<footer id="footer-section" style="background:#007B7F; color:white; padding:50px 20px; margin-top:50px; display:none;">
    <div class="row">
        <div class="col-md-6 mb-4">
            <h5 style="font-weight:700;">About Us</h5>
            <p>
                We are committed to providing the best dental care for you and your family. 
                Reach out to us anytime for inquiries, appointments, or guidance on oral health. 
            </p>
        </div>
        <div class="col-md-6">
            <img src="{% static 'images/room.jpg' %}" style="width:100%; border-radius:12px;">
        </div>
        <hr style="border-color: rgba(255,255,255,0.3); margin-top:20px;">
        <div class="text-center">&copy;2025 CrystalSmile Dental Clinic. All rights reserved.</div>
    </div>
</footer>

<!-- JS -->
<script>
    // Fade in Services & Footer
    window.addEventListener('load', function() {
        setTimeout(function() {
            const section = document.getElementById('services-section');
            section.style.display = 'flex';
            section.style.opacity = 0;
            let op = 0;
            const fade = setInterval(() => {
                if(op >= 1) clearInterval(fade);
                section.style.opacity = op;
                op += 0.05;
            }, 50);

            setTimeout(function() {
                const footer = document.getElementById('footer-section');
                footer.style.display = 'block';
                footer.style.opacity = 0;
                let fop = 0;
                const fadeFooter = setInterval(() => {
                    if(fop >= 1) clearInterval(fadeFooter);
                    footer.style.opacity = fop;
                    fop += 0.05;
                }, 30);
            }, 800);
        }, 1000);
    });

    // Doctor Selection
    const doctorsData = {
        {% for doctor in doctors %}
        {{ doctor.id }}: {
            full_name: "{{ doctor.full_name|escapejs }}",
            degree: "{{ doctor.degree|default:'N/A'|escapejs }}",
            specialization: "{{ doctor.specialization|default:'N/A'|escapejs }}",
            experience_years: "{{ doctor.experience_years|default:'0' }}",
            bio: "{{ doctor.bio|default:'N/A'|escapejs }}",
            profile_picture: "{{ doctor.profile_picture|default:'/static/images/default_profile.png' }}"
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    };

    const select = document.getElementById('doctor-select');
    select.addEventListener('change', function() {
        const docId = this.value;
        const detailsTab = document.getElementById('doctor-details');

        if (!docId) {
            detailsTab.style.display = 'none';
            document.getElementById('selected-doctor').value = '';
            return;
        }

        const doc = doctorsData[docId];
        document.getElementById('selected-doctor').value = docId;
        document.getElementById('doc-name').textContent = doc.full_name;
        document.getElementById('doc-degree').textContent = doc.degree;
        document.getElementById('doc-specialization').textContent = doc.specialization;
        document.getElementById('doc-experience').textContent = doc.experience_years;
        document.getElementById('doc-bio').textContent = doc.bio;
        document.getElementById('doc-profile').src = doc.profile_picture;

        detailsTab.style.display = 'block';
    });
</script>

<style>
    footer input, footer textarea { border-radius:6px; border:2px solid black; padding:10px; width:100%; }
    footer input:focus, footer textarea:focus { outline:none; box-shadow:0 0 5px black; }
    footer button:hover { transform:translateY(-2px); transition:all 0.2s; }

    h1 { font-family:'Calibri'; font-size:3rem; color:#0B0047; font-weight:700; letter-spacing:1px; text-shadow:1px 1px 4px rgba(0,0,0,0.1); }
    h2 { font-family:'Nunito Sans', sans-serif; font-size:2rem; font-weight:700; color:#FF4040; text-transform:uppercase; letter-spacing:1px; border-bottom:3px solid #00a2e2; display:inline-block; padding-bottom:6px; margin:25px auto 40px auto; text-align:center; }

    #services-section .card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0, 123, 127, 0.3); }
    .card-title { text-shadow: 1px 1px 3px rgba(0,123,127,0.3); }
</style>

{% endblock %}
